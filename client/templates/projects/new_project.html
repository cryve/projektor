<template name="newProject">
  <div class="container">
      <div class="row">
          <div class="col-lg-12">
              <h1 class="page-header">
                <!-- <span id="title" class="editable required-editable" data-pk="{{_id}}"></span> <span class="editable-icon glyphicon glyphicon-pencil text-primary"></span><br> -->
                {{> editTitle currentDoc=this drafts=getDraftsCollection }}
                <!-- <small><span id="subtitle" data-pk="{{_id}}"></span></small> -->
              </h1>
          </div>
      </div> <!-- /.row -->
      <div class="row">
        <div class="col-md-8 col-lg-8">
          <div class="panel panel-default">
            <div class="panel-header">
              <div class="well img-placeholder">
                <div class="center-block text-center">
                  <h4 class="text-info">Bild hierhin ziehen und ablegen<br>oder</h4>
                <button class="btn btn-info">Bild auswählen</button>
                </div>
              </div>
            </div> <!-- /.panel-header -->

                  <div class="panel-body">
                  <div class="row">
                    <div class="col-sm-12">
                      <ul class="list-inline thumbnails">
                        <li>
                          <a href="#">
                          <img class="img-responsive" src="https://unsplash.it/115/65?random=1" alt="">
                          </a>
                        </li>
                        <li>
                          <a href="#">
                            <div class="well thumbnail-placeholder"></div>
                          </a>
                        </li>
                        <li>
                          <a href="#">
                            <img class="img-responsive" src="https://unsplash.it/115/65?random=3" alt="">
                          </a>
                        </li>
                        <li>
                          <a href="#">
                            <div class="well thumbnail-placeholder"></div>
                          </a>
                        </li>
                        <li>
                          <a href="#">
                            <div class="well thumbnail-placeholder"></div>
                          </a>
                        </li>
                      </ul>
                    </div> <!-- /.col-sm-12 gallery thumbnails -->
                  </div> <!-- /.row -->
                  <div class="row">
                    <div class="col-sm-12">
                      {{> editDescription currentDoc=this drafts=getDraftsCollection }}
                    </div> <!-- /.col description -->
                  </div>
                  <div class="row">
                    <div class="col-sm-12">
                      {{> editTags currentDoc=this drafts=getDraftsCollection }}
                    </div> <!-- /.col Tags -->
                  </div> <!-- /.row Tags -->

                  <br>
                  <button class="btn btn-default">Abbrechen</button>
                  <button id="btn-create" class="btn btn-primary">Projekt erstellen</button>

                </div> <!-- /.panel-body -->
              </div> <!-- /.panel -->
        </div> <!-- /.col-md-8 -->
        <div class="col-lg-4">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <span class="panel-title">Team</span>
                </div>

                <div class="panel-body">
                  <ul class="media-list">
                    <li class="media">
                      <div class="media-left">
                        <a href="#">
                          <img class="media-object img-circle" src="{{getAvatarURL this.owner.userId "avatar"}}" alt="...">
                        </a>
                      </div>
                      <div class="media-body">
                        <h4 class="media-heading">
                          <a href="#">{{getFullUsername this.owner.userId}}</a>
                        </h4>
                        <p class="text-muted">
                          {{#if editOwnerActive }}
                            <div class="form-group">
                              {{#autoForm id="newProject" type="update" doc=this collection=getDraftsCollection }}
                                {{> afFieldInput name="owner.role" type="text" placeholder="Aufgaben im Projekt"}}
                              {{/autoForm}}
                            </div>
                            <div class="form-group">
                              <button type="submit" class="btn btn-primary btn-abort-owner-editing"><span class="glyphicon glyphicon-ok"></span></button>
                              <button type="reset" class="btn btn-default btn-abort-owner-editing"><span class="glyphicon glyphicon-remove"></span></button>
                            </div>
                          {{else}}
                            {{owner.role}}
                            <a href="#"><span class="glyphicon glyphicon-pencil text-primary btn-edit-owner"></span></a>
                          {{/if}}
                        </p>
                      </div>
                    </li>
                    {{#each teamMember in team}}
                      {{> member currentDoc=this draftId=this._id userId=teamMember.userId role=teamMember.role userList=(suggestedUsers teamMember.userId) slot=@index drafts=getDraftsCollection }}
                    {{/each}}
                    {{> addMember currentDoc=this userList=(suggestedUsers " ") drafts=getDraftsCollection }}
                  </ul>
                </div>
              </div> <!-- /.panel-default -->
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h2 class="panel-title">Gesuchte Fähigkeiten</h2>
                </div>
                <div class="panel-body">
                  <ul>
                      {{#each job in jobs}}
                        {{>jobItem title=job draftId=../_id currentIndex=@index}}
                      {{/each}}
                      <li><span class="add-job" data-pk="{{_id}}"></span></li>
                  </ul>
                </div>
              </div> <!-- /.panel Wanted Skills -->
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h2 class="panel-title">Kontakt</h2>
                </div>
                <div class="panel-body">
                  <ul class="list-unstyled">
                      <!-- <li><span class="glyphicon glyphicon-envelope"></span> <a href="#">mitmachen@projekt.de</a></li>
                      <li><span class="glyphicon glyphicon-home"></span> <a href="#">www.projekt.de</a> </li>
                      <li><span class="glyphicon glyphicon-earphone"></span> 0123 45678910</li>
                      <li><span class="glyphicon glyphicon-facetime-video"></span> Skype: nickname</li> -->
                      {{#each contact in contacts}}
                        {{>contactItem medium=contact.medium approach=contact.approach currentDoc=this drafts=getDraftsCollection slot=@index}}
                      {{/each}}
                      {{> addContact currentDoc=this drafts=getDraftsCollection }}
                  </ul>
                </div>
              </div> <!-- /.panel Contact -->
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h2 class="panel-title">Details</h2>
                </div>
                <div class="panel-body">
                  <dl class="dl">
                    <dt>Projektanlass</dt>
                    <dd><span id="edit-occasions" data-type="select2" data-placeholder="Vorlesung, Seminar, Schein oder andere Motivation" data-emptytext="Anlass hinzufügen" data-title="Add occasions" data-pk="{{_id}}"></span></dd>
                    <dt>Betreuer</dt>
                    <dd>Prof. Vorname Nachname, Prof. Vorname Nachname</dd>
                    <dt>Deadline</dt>
                    <dd>12. Oktober 2016</dd>

                  </dl>
                </div>
              </div> <!-- /.panel Wanted Skills -->

            </div> <!-- /.col-md-4 -->
      </div><!-- /.row -->
    </div> <!-- /.container -->
</template>

<template name="addMember">
  <li class="media">
    <div class="media-left">
      <button id="btn-add-member" class="btn btn-primary btn-lg btn-round"><span class="text-center glyphicon glyphicon-plus"></span></button>
    </div>
    <div class="media-body">
      {{#if editActive}}
        <!-- <h4 class="media-heading"><a href="#" class="add-member" data-pk="{{draftId}}"></a></h4> -->
        {{#autoForm id="addMember" type="update-pushArray" doc=currentDoc collection=drafts scope="team"}}
          <div class="form-group">
            {{> afFieldInput name="userId" type="select2" options=userList placeholder="Neues Mitglied auswählen" allowClear=true}}
            {{> afFieldInput name="role" type="text" placeholder="Aufgaben im Projekt"}}
          </div>
          <div class="form-group">
            <button type="submit" class="btn btn-primary btn-abort-adding"><span class="glyphicon glyphicon-ok"></span></button>
            <button type="reset" class="btn btn-default btn-abort-adding"><span class="glyphicon glyphicon-remove"></span></button>
          </div>
        {{/autoForm}}
      {{/if}}
    </div>
  </li>
</template>

<template name="member">
  <li class="media">
    <div class="media-left">
      <a href="#">
        <img class="media-object img-circle" src="{{getAvatarURL this.userId "avatar"}}" alt="...">
      </a>
    </div>
    <div class="media-body">

        <!-- <a href="#" class="select-member" data-pk="{{draftId}}">{{getFullUsername this.userId}}</a> -->
        {{#if editActive}}
          {{log this}}
          {{#autoForm id="member" type="update" doc=currentDoc collection=drafts setArrayItems=true}}
            <div class="form-group">
              <h4 class="media-heading">
                {{> afFieldInput name=teamUserIdField type="select2" options=userList placeholder="Neues Mitglied auswählen" value=this.userId }}
              </h4>
              <p>
                {{> afFieldInput name=teamUserRoleField type="text" options=userList placeholder="Aufgaben im Projekt"}}
              </p>
            </div>
            <div class="form-group">
              <button type="submit" class="btn btn-primary btn-abort-editing"><span class="glyphicon glyphicon-ok"></span></button>
              <button type="reset" class="btn btn-default btn-abort-editing"><span class="glyphicon glyphicon-remove"></span></button>
            </div>
          {{/autoForm}}
        {{else}}
          {{log this}}
          <h4 class="media-heading">
            <a href="#">{{getFullUsername this.userId}}</a>
            <a href="#"><span class="glyphicon glyphicon-pencil text-primary btn-edit-member"></span></a>
            <a href=""><span class="glyphicon glyphicon-minus text-danger btn-delete-member"></span></a>
          </h4>
          <p class="text-muted">{{role}}</p>
        {{/if}}
      <!-- <p class="text-muted"><span class="edit-member-role" data-pk="{{draftId}}" data-source="{{suggestedUsers}}">{{role}}</span></p> -->
    </div>
  </li>
</template>

<template name="jobItem">
  <li>
    <span class="edit-job" data-pk="{{draftId}}" data-index="{{currentIndex}}">{{title}}</span>
  </li>
</template>

<template name="contactItem">
  <li>
    {{#if editActive}}
    {{log contactMediumField}}
    {{log contactApproachField}}
      {{#autoForm id="contactItem" type="update" doc=currentDoc collection=drafts setArrayItems=true}}
        {{> afFieldInput name=contactMediumField type="select2" options=mediumOptions placeholder="Kontaktmittel auswählen" }}
        {{> afFieldInput name=contactApproachField type="text" options=mediumOptions placeholder="Details zur Kontaktaufnahme"}}
        <div class="form-group">
          <button type="submit" class="btn btn-primary btn-abort-editing"><span class="glyphicon glyphicon-ok"></span></button>
          <button type="reset" class="btn btn-default btn-abort-editing"><span class="glyphicon glyphicon-remove"></span></button>
        </div>
      {{/autoForm}}
    {{else}}
      {{medium}}: {{approach}} <a href="#"><span class="glyphicon glyphicon-pencil text-primary btn-edit-contact"></span></a>
      <a href=""><span class="glyphicon glyphicon-minus text-danger btn-delete-contact"></span></a>
    {{/if}}
  </li>
</template>

<template name="addContact">
  <li>
    <button id="btn-add-contact" class="btn btn-primary btn-round"><span class="text-center glyphicon glyphicon-plus"></span></button>
    {{#if editActive}}
      {{#autoForm id="addContact" type="update-pushArray" doc=currentDoc collection=drafts scope="contacts"}}
        <div class="form-group">
          {{> afFieldInput name="medium" type="select2" options=mediumOptions placeholder="Neues Kommunikationsmittel hinzufügen" }}
          {{> afFieldInput name="approach" type="text" placeholder="Details zur Kontaktaufnahme"}}
        </div>
        <div class="form-group">
          <!-- <button type="submit" class="btn btn-primary btn-abort-adding"><span class="glyphicon glyphicon-ok"></span></button> -->
          <button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-ok"></span></button>
          <button type="reset" class="btn btn-default btn-abort-adding"><span class="glyphicon glyphicon-remove"></span></button>
        </div>
      {{/autoForm}}
    {{/if}}
  </li>
</template>

<template name="editTitle">
  {{#if editActive }}
    {{#autoForm id="editTitle" type="update" doc=currentDoc collection=drafts }}
    <div class="form-group">
      {{> afFieldInput name="title" type="text" placeholder="Titel deines Projekts" }}
      {{> afFieldInput name="subtitle" type="text" placeholder="Untertitel hinzufügen" }}
    </div>
    <div class="form-group">
      <button type="submit" class="btn btn-primary btn-abort-editing"><span class="glyphicon glyphicon-ok"></span></button>
      <button type="reset" class="btn btn-default btn-abort-editing"><span class="glyphicon glyphicon-remove"></span></button>
    </div>
    {{/autoForm}}
  {{ else }}
    {{#if currentDoc.title}}
      {{currentDoc.title}}
    {{else}}
      <span class="text-danger"><em>Titel deines Projekts</em></span>
    {{/if}}
    <a href="#"><span class="glyphicon glyphicon-pencil text-primary btn-edit-title"></span></a><br>
    <small>{{currentDoc.subtitle}}</small>
  {{/if}}
</template>

<template name="editDescription">
  {{#if editActive}}
    {{#autoForm id="editDescription" type="update" doc=currentDoc collection=drafts }}
    <div class="form-group">
      {{> afFieldInput name="description" type="textarea" rows=6 placeholder="Beschreibung deines Projekts" }}
    </div>
    <div class="form-group">
      <button type="submit" class="btn btn-primary btn-abort-editing"><span class="glyphicon glyphicon-ok"></span></button>
      <button type="reset" class="btn btn-default btn-abort-editing"><span class="glyphicon glyphicon-remove"></span></button>
    </div>
    {{/autoForm}}
    {{ else }}
      {{#if currentDoc.description}}
        {{currentDoc.description}}
      {{else}}
        <span class="text-primary"><em>Beschreibung hinzufügen</em></span>
      {{/if}}
      <a href="#"><span class="glyphicon glyphicon-pencil text-primary btn-edit-description"></span></a>
    {{/if}}
</template>

<template name="editTags">
  {{#if editActive}}
    {{#autoForm id="editTags" type="update" doc=currentDoc collection=drafts }}
    <div class="form-group">
      {{> afFieldInput name="tags" type="tags" maxTags=10 maxChars=20 trimValue=true placeholder="Tags eingeben" }}
    </div>
    <div class="form-group">
      <button type="submit" class="btn btn-primary btn-abort-editing"><span class="glyphicon glyphicon-ok"></span></button>
      <button type="reset" class="btn btn-default btn-abort-editing"><span class="glyphicon glyphicon-remove"></span></button>
    </div>
    {{/autoForm}}
    {{ else }}
      {{#if currentDoc.tags}}
        {{currentDoc.tags}}
      {{else}}
        <span class="text-primary"><em>Tags hinzufügen</em></span>
      {{/if}}
      <a href="#"><span class="glyphicon glyphicon-pencil text-primary btn-edit-tags"></span></a>
    {{/if}}
</template>
