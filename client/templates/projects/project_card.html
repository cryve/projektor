<template name="projectCard">
  <div class="panel panel-default cover-card">
    <div class="panel-header cover">
      <img class="img-responsive center-block" src="{{getImgURL currentDoc.coverImg "cover400"}}">
    </div> <!-- /.panel-header -->
    <div class="panel-body cover-card-body">
      <div class="expandable-trigger">

      </div>
      <div class="expandable-content">
        <div class="member-icons-box">
          <ul class="member-icons list-inline">
          {{#each member in currentDoc.team}}
            {{#if $lt @index (itemsToShow currentDoc.team.length 3 1)}}
              <li>
                <a href="{{pathFor 'userProfile' _id=member.userId }}">
                  <img class="img-circle" rel="tooltip" title="{{getFullUsername member.userId}}" src={{getAvatarURL member.userId "avatar20"}}>
                </a>
              </li>
            {{/if}}
          {{/each}}
          {{#if itemsRemaining currentDoc.team.length 3 1}}
            <li class="remaining-member">
              <!-- <span class="badge">+{{itemsRemaining currentDoc.team.length 5 1}}</span> -->
              <a class="text-info" href="{{pathFor 'projectDetails' _id=currentDoc._id title=currentDoc.title previousPage=previousPage }}">
                <div class="text-center bg-info circle20-remaining-members">
                  <span>
                    <strong>+{{itemsRemaining currentDoc.team.length 3 1}}</strong>
                  </span>
                </div>
              </a>
            </li>
          {{/if}}
        </ul>
        </div> <!-- /.member-icons-box -->
        <!-- <div class="cover-card-title"> -->
        <div class="cover-card-title">
          {{> projectCardTitle _id=currentDoc._id title=currentDoc.title subtitle=currentDoc.subtitle subtitleLines=1 previousPage=previousPage}}
        </div>
        <!-- </div> -->
        {{>projectCardJobs jobs=currentDoc.jobs expandable=true}}
      </div> <!-- ./expandable-content -->
      {{>projectCardTags tags=currentDoc.tags}}
    </div> <!-- ./panel-body cover-card-body -->
    <div class="panel-footer">
      {{>projectCardFooter beginning=currentDoc.beginning deadline=currentDoc.deadline}}
    </div> <!-- /.panel-footer -->
  </div> <!-- /.panel project card -->
</template>

<template name="projectCardCoverless">
  <div class="panel panel-default coverless-card">
    <div class="panel-body coverless-card-body">
      <div class="coverless-card-title">
        {{> projectCardTitle _id=currentDoc._id title=currentDoc.title subtitle=currentDoc.subtitle subtitleLines=2 previousPage=previousPage}}
      </div>
      <hr class="hr-top">
      <ul class="member-icons list-inline">
        {{#each member in currentDoc.team}}
          {{#if $lt @index (itemsToShow currentDoc.team.length 5 1)}}
            <li>
              <a href="{{pathFor 'userProfile' _id=member.userId }}">
                <img class="img-circle" rel="tooltip" title="{{getFullUsername member.userId}}" src={{getAvatarURL member.userId "avatar20"}}>
              </a>
            </li>
          {{/if}}
        {{/each}}
        {{#if itemsRemaining currentDoc.team.length 5 1}}
          <li class="remaining-member">
            <a class="text-info" href="{{pathFor 'projectDetails' _id=currentDoc._id title=currentDoc.title previousPage=previousPage}}">
              <div class="text-center bg-info circle30-remaining-members">
                <span>
                  <strong>+{{itemsRemaining currentDoc.team.length 5 1}}</strong>
                </span>
              </div>
            </a>
          </li>
        {{/if}}
      </ul>
      <hr class="hr-bottom">
      {{>projectCardJobs jobs=currentDoc.jobs expandable=false}}
      {{>projectCardTags tags=currentDoc.tags}}
    </div> <!-- /.panel-body -->
    <div class="panel-footer">
      {{>projectCardFooter beginning=currentDoc.beginning deadline=currentDoc.deadline}}
    </div> <!-- /.panel-footer -->
  </div> <!-- /.panel project card -->
</template>

<template name="projectCardTitle">
  <h3>
    {{log this.previousPage}}
    <a href="{{pathFor 'projectDetails' _id=_id title=title previousPage=this.previousPage}}" class="{{#if subtitle}}title-1row{{else}}title-2row{{/if}}">{{title}}</a>
    {{#if subtitle}}
      <br>
      <small class="subtitle-{{subtitleLines}}row">{{subtitle}}</small>
    {{/if}}
  </h3>
</template>

<template name="projectCardJobs">
  <div class="jobs-box">
    <span class="text-muted text-center jobs-box-header"><span>Gesucht</span></span>
    <div class="container jobs-box-body {{#if expandable}}expandable{{/if}}">
      <ul class="jobBreak list-unstyled">
          {{#each job in jobs}}
            <li class="text-primary {{#if $gte @index 3}}job-expand{{/if}}">
              <span class="glyphicon glyphicon-search"></span> {{job.joblabel}}
            </li>
          {{/each}}
        </ul>
    </div>
  </div> <!-- ./jobs-box-decoration -->
</template>

<template name="projectCardTags">
  <span class="ellipsis-tags">
    {{#each tag in tags}}
      <span class="label label-default">{{tag}}</span>
    {{/each}}
  </span>
</template>

<template name="projectCardFooter">
  <ul class="list-inline text-center">
    {{#if $and beginning deadline}}
      <li class="text-muted"><small>{{readableDate beginning}} - {{readableDate deadline}}</small> </li>
    {{/if}}

    {{#if $and ($not beginning) ($not deadline)}}
      <li class="text-muted"> <small>Kein Datum gesetzt</small> </li>
    {{/if}}

    {{#if $and ($not beginning) deadline}}
      <li class="text-muted"> <small>Deadline: {{readableDate deadline}}</small> </li>
    {{/if}}

    {{#if $and beginning ($not deadline)}}
      <li class="text-muted"> <small>Starttermin: {{readableDate beginning}} </small> </li>
    {{/if}}

  </ul>
</template>
